<!-- TMPL_IF NAME="opac" -->
    <!-- TMPL_INCLUDE NAME="opac-top.inc" -->
<!-- TMPL_ELSE -->
    <!-- TMPL_INCLUDE NAME="cat-top.inc" -->
<!-- /TMPL_IF -->
<div id="mainbloc">

<h1 class="catalogue">Пошук у каталозі</h1>

<form name="f" method="post" action="/cgi-bin/koha/search.marc/search.pl">
	<input type="hidden" name="op" value="do_search">
	<input type="hidden" name="type" value="intranet">
	<input type="hidden" name="nbstatements" value="<!-- TMPL_VAR NAME="nbstatements" -->">
	<div class="bloc25">
		<h2 class="catalogue">Пошук за</h2>
		<p>
			<input type="hidden" name="nbstatements" value="<!-- TMPL_VAR NAME="nbstatements" -->">
			<label class="label100" for="keyword">Будь-яке слово</label>
			<input type="hidden" name="marclist" value="">
			<input type="hidden" name="and_or" value="and">
			<input type="hidden" name="excluding" value="">
			<input type="hidden" name="operator" value="contains">
			<input type="text" name="value" id="keyword" onchange="sql_update()" size="35">
		</p>
		<p>
			<label class="label100" for="title">Заголовок</label>
			<input type="hidden" name="marclist" value="biblio.title">
			<input type="hidden" name="and_or" value="and">
			<input type="hidden" name="excluding" value="">
			<input type="hidden" name="operator" value="contains">
			<input type="text" name="value" id="title" onchange="sql_update()" size="35">
			<!-- TMPL_UNLESS Name="Disable_Dictionary" -->
				<a href="javascript:Dopop('dictionary.pl?marclist=biblio.title&amp;type=intranet&amp;index=1',1)" class="button catalogue">
					...
				</a>
			<!-- /TMPL_UNLESS -->
		</p>
		<p>
			<label class="label100" for="author">Автор</label> <input type="hidden" name="marclist" value="biblio.author">
			<input type="hidden" name="and_or" value="and">
			<input type="hidden" name="excluding" value="">
			<input type="hidden" name="operator" value="contains">
			<input type="text" name="value" id="author" onchange="sql_update()" size="35">
			<!-- TMPL_UNLESS Name="Disable_Dictionary" -->
				<a href="javascript:Dopop('dictionary.pl?marclist=biblio.author&amp;type=intranet&amp;index=2',2)" class="button catalogue">
					...
				</a>
			<!-- /TMPL_UNLESS -->
		</p>
		<p>
			<label class="label100" for="subject">Тематика</label>
			<input type="hidden" name="marclist" value="bibliosubject.subject">
			<input type="hidden" name="and_or" value="and">
			<input type="hidden" name="excluding" value="">
			<input type="hidden" name="operator" value="contains">  
			<input type="text" name="value" id="subject" onchange="sql_update()" size="35">
			<!-- TMPL_UNLESS Name="Disable_Dictionary" -->
				<a href="javascript:Dopop('dictionary.pl?marclist=bibliosubject.subject&amp;type=intranet&amp;index=3',3)" class="button catalogue">
					...
				</a>
			<!-- /TMPL_UNLESS -->
		</p>
		<p>
			<label class="label100" for="itemtype">Тип одиниці зберігання </label>
			<input type="hidden" name="marclist" value="biblioitems.itemtype">
			<input type="hidden" name="and_or" value="and">
			<input type="hidden" name="excluding" value="">
			<input type="hidden" name="operator" value="=">
			<!-- TMPL_VAR name="CGIitemtype" -->
		</p>
		<p>
				<label class="label100" for="branch">Підрозділ</label>
				<input type="hidden" name="marclist" value="items.holdingbranch">
				<input type="hidden" name="and_or" value="and">
				<input type="hidden" name="excluding" value="">
				<input type="hidden" name="operator" value="=">  
				<!-- TMPL_VAR name="CGIbranch" -->
		</p>
	</div>
	<div class="bloc25">
		<h2 class="catalogue">Інші параметри</h2>
		<p>
				<label class="label100" for="barcode">Штрихкод одиниці збірігання</label>
				<input type="hidden" name="marclist" value="items.barcode">
				<input type="hidden" name="and_or" value="and">
				<input type="hidden" name="excluding" value="">
				<input type="hidden" name="operator" value="contains">
				<input type="text" name="value" id="barcode" onchange="sql_update()"> 
		</p>
		<p>
			<label class="label100" for="callno">Шифр для замовлення</label>
			<input type="hidden" name="marclist" value="items.itemcallnumber">
			<input type="hidden" name="and_or" value="and">
			<input type="hidden" name="excluding" value="">
			<input type="hidden" name="operator" value="start">
			<input type="text" name="value" id="callno" onchange="sql_update()">
		</p>
		<p>
			<label class="label100" for="isbn">ISBN</label>
			<input type="hidden" name="marclist" value="biblioitems.isbn">
			<input type="hidden" name="and_or" value="and">
			<input type="hidden" name="excluding" value="">
			<input type="hidden" name="operator" value="=">
			<input type="text" name="value" id="isbn" onchange="sql_update()">
		</p>
		<p>
			<label class="label100" for="publisher">Видавець</label>
			<input type="hidden" name="marclist" value="biblioitems.publishercode">
			<input type="hidden" name="and_or" value="and">
			<input type="hidden" name="excluding" value="">
			<input type="hidden" name="operator" value="contains">
			<input type="text" name="value" id="publisher" onchange="sql_update()">
		</p>
	</div>
	<div id="bloc100">
		<h2 class="catalogue">Більше полів</h2>
		<!-- TMPL_LOOP NAME="statements" -->
			<p>
				<select name="and_or" size="1" onchange="sql_update()">
					<option value="and">і</option>
					<option <!-- TMPL_IF NAME="or" -->selected <!-- /TMPL_IF -->value="or">або</option>
				</select>
				<!-- TMPL_VAR NAME="marclist" -->
				<select name="excluding" size="1" onchange="sql_update()">
					<option value="0"> </option>
					<option <!-- TMPL_IF NAME="not" -->selected <!-- /TMPL_IF -->value="1">не</option>
				</select>
				<select name="operator" size="1" onchange="sql_update()">
					<option <!-- TMPL_IF NAME="contains" -->selected<!-- /TMPL_IF --> value="contains">містить</option>
					<option <!-- TMPL_IF NAME="eq" -->selected<!-- /TMPL_IF --> value="=">рівне</option>
					<option <!-- TMPL_IF NAME="start" -->selected<!-- /TMPL_IF --> value="start">починається з</option>
					<option <!-- TMPL_IF NAME="gt" -->selected<!-- /TMPL_IF --> value=">">більше аніж</option>
					<option <!-- TMPL_IF NAME="ge" -->selected<!-- /TMPL_IF --> value=">=">більше або рівне</option>
					<option <!-- TMPL_IF NAME="lt" -->selected<!-- /TMPL_IF --> value="<">менше аніж</option>
					<option <!-- TMPL_IF NAME="le" -->selected<!-- /TMPL_IF --> value="<=">менше або рівне</option>
				</select>
				<input type="text" name="value" onChange="sql_update()" <!-- TMPL_IF NAME="value" -->value="<!-- TMPL_VAR NAME="value" -->"<!-- /TMPL_IF -->>
			</p>
		<!-- /TMPL_LOOP -->
		<p>
		<input type="button" value="Додати критерій" onclick="AddStatement()" class="button catalogue">
		Попередження : оператор "містить" НЕ діє, якщо Ви вводите 2 та менше символів</p>
	</div>
	<div class="bloc25">
		<p><textarea name="sql" rows="3" cols="70" disabled readonly></textarea></p>
		<p>Результатів на сторінку: 
			<select name="resultsperpage" size="1">
				<option value="20">20</option>
				<option value="50">50</option>
				<option value="100">100</option>
			</select>
		Впорядкувати за: 
			<select name="orderby" size="1">
				<option value="biblio.title">Заголовок</option>
				<option value="biblio.author">Автор</option>
				<option value="biblioitems.dewey">Індекс Дьюї (ДДК)</option>
				<option value="biblioitems.publicationyear">Рік публікації</option>
				<option value="biblioitems.publishercode">Видавець</option>
			</select>
			<select name="desc_or_asc" size="1">
				<option value="ASC">по зростанню</option>
				<option value="DESC">по спаданню</option>
			</select>
		</p>
		<p>
			<input type="submit" value="Почати пошук" class="button catalogue">
			<a href="/cgi-bin/koha/search.marc/suggest.pl" onclick="PopupSuggestion(); return false;" class="button catalogue">Пропозиції орфографії</a>
		</p>
	</div>
</form>

<script language="javascript" type="text/javascript">
function sql_update() {
document.f.sql.value="";
	for (i=0 ; i<document.f.marclist.length ; i++) {
		if (document.f.value[i].value.length>0) {
			document.f.sql.value = document.f.sql.value+
										document.f.and_or[i].value + ' (' +
										document.f.excluding[i].value + ' ' +
										document.f.marclist[i].value + ' ' +
										document.f.operator[i].value + ' ' +
										'\''+document.f.value[i].value + '\') ';
		}
	}
}

function AddStatement() {

	document.forms['f'].op.value="AddStatement";
	document.f.submit();
}

function Dopop(link,i) {
	var searchstring=document.forms['f'].value[i].value;
	newin=window.open(link+'&amp;search='+searchstring,"popup",'width=700,height=550,toolbar=false,scrollbars=yes');
}


function PopupSuggestion() {
    var strQuery="";
	for (i=0 ; i<document.f.marclist.length ; i++) {
		if (document.f.value[i].value.length>0) {
		    strQuery += " "+document.f.value[i].value;
		}
	}
	newin=window.open("suggest.pl?Q="+strQuery,"Suggestions",'width=500,height=400,toolbar=false,scrollbars=yes');
}

</script>
</div>
<!-- TMPL_IF NAME="opac" -->
    <!-- TMPL_INCLUDE NAME="opac-bottom.inc" -->
<!-- TMPL_ELSE -->
    <!-- TMPL_INCLUDE NAME="cat-bottom.inc" -->
<!-- /TMPL_IF -->

